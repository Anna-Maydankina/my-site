{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="text-center mb-4">
                <h1 style="color: #453518;">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1>
                <p class="lead">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –≤–∞—à –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç!</p>
            </div>

            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #453518; color: white;">
                    <h4 class="mb-0">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <table class="table table-bordered">
                                <tr>
                                    <th>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</th>
                                    <td>{{ user.username }}</td>
                                </tr>
                                <tr>
                                    <th>–ù–∏–∫–Ω–µ–π–º:</th>
                                    <td>
                                        {% if user.nickname %}
                                            {{ user.nickname }}
                                        {% else %}
                                            <span class="text-muted">–ù–µ —É–∫–∞–∑–∞–Ω</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr>
                                    <th>–°—Ç—Ä–∞–Ω–∞:</th>
                                    <td>
                                        {% if user.country %}
                                            {{ user.get_country_display }}
                                        {% else %}
                                            <span class="text-muted">–ù–µ —É–∫–∞–∑–∞–Ω–∞</span>
                                        {% endif %}
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <table class="table table-bordered">
                                <tr>
                                    <th>Email:</th>
                                    <td>
                                        {% if user.email %}
                                            {{ user.email }}
                                        {% else %}
                                            <span class="text-muted">–ù–µ —É–∫–∞–∑–∞–Ω</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                <!-- –î–û–ë–ê–í–õ–ï–ù –¢–ï–õ–ï–§–û–ù -->
                                <tr>
                                    <th>–¢–µ–ª–µ—Ñ–æ–Ω:</th>
                                    <td>
                                        {% if user.phone %}
                                            {{ user.phone }}
                                        {% else %}
                                            <span class="text-muted">–ù–µ —É–∫–∞–∑–∞–Ω</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr>
                                    <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</th>
                                    <td>{{ user.date_joined|date:"d.m.Y" }}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –î–µ–π—Å—Ç–≤–∏—è -->
            <div class="card mb-4">
                <div class="card-header" style="background-color: #453518; color: white;">
                    <h4 class="mb-0">–î–µ–π—Å—Ç–≤–∏—è</h4>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <a href="{% url 'fanfic_create' %}" class="btn w-100" style="background-color: #453518; color: white; text-decoration: none;">
                                üìù –ù–æ–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="{% url 'my_bookmarks' %}" class="btn w-100" 
                               style="background-color: #28a745; color: white; border: none; text-decoration: none;">
                                üîñ –ú–æ–∏ –∑–∞–∫–ª–∞–¥–∫–∏
                                {% if bookmarks_count > 0 %}
                                <span class="badge bg-light text-dark ms-1">{{ bookmarks_count }}</span>
                                {% endif %}
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="{% url 'profile_edit' %}" class="btn btn-outline-secondary w-100">
                                ‚öôÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ -->
            <div class="card mb-4">
                <div class="card-header" style="background-color: #28a745; color: white;">
                    <h4 class="mb-0">üì¢ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏</h4>
                </div>
                <div class="card-body">
                    {% if published_fanfics %}
                        <div class="row g-3">
                            {% for fanfic in published_fanfics %}
                            <div class="col-12">
                                <div class="card border-success">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                            <h5 class="card-title mb-0">{{ fanfic.title }}</h5>
                                            <div>
                                                <small class="text-muted">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: {{ fanfic.created_at|date:"d.m.Y" }}</small>
                                                <span class="badge bg-success ms-2">–ê–∫—Ç–∏–≤–Ω–æ</span>
                                            </div>
                                        </div>
                                        {% if fanfic.description %}
                                        <p class="card-text">{{ fanfic.description|truncatewords:30 }}</p>
                                        {% endif %}
                                        {% if fanfic.tags %}
                                        <div class="mb-3">
                                            {% for tag in fanfic.get_tags_list %}
                                            <span class="badge bg-primary me-1">{{ tag }}</span>
                                            {% endfor %}
                                        </div>
                                        {% endif %}
                                        <div class="d-flex gap-1 flex-wrap">
                                            <a href="{% url 'fanfic_detail' fanfic.pk %}" class="btn btn-sm btn-outline-primary">–ß–∏—Ç–∞—Ç—å</a>
                                            <a href="{% url 'fanfic_edit' fanfic.pk %}" class="btn btn-sm btn-outline-secondary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                                            <a href="{% url 'archive_fanfic' fanfic.pk %}" 
                                               class="btn btn-sm btn-outline-warning">
                                                –í –∞—Ä—Ö–∏–≤
                                            </a>
                                            <button type="button" class="btn btn-sm btn-outline-danger" 
                                                    data-bs-toggle="modal" data-bs-target="#moveToTrashModal{{ fanfic.id }}">
                                                –£–¥–∞–ª–∏—Ç—å
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center text-muted">
                            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- –ú–æ–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∏ -->
            <div class="card mb-4">
                <div class="card-header" style="background-color: #6c757d; color: white;">
                    <h4 class="mb-0">üìÅ –ú–æ–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∏</h4>
                </div>
                <div class="card-body">
                    {% if draft_fanfics %}
                        <div class="row g-3">
                            {% for fanfic in draft_fanfics %}
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                            <h5 class="card-title mb-0">{{ fanfic.title }}</h5>
                                            <small class="text-muted">–ò–∑–º–µ–Ω–µ–Ω–æ: {{ fanfic.updated_at|date:"d.m.Y" }}</small>
                                        </div>
                                        {% if fanfic.description %}
                                        <p class="card-text">{{ fanfic.description|truncatewords:30 }}</p>
                                        {% endif %}
                                        <div class="mb-3">
                                            <span class="badge bg-secondary me-1">–ß–µ—Ä–Ω–æ–≤–∏–∫</span>
                                            <span class="badge bg-secondary">–ù–µ–∑–∞–≤–µ—Ä—à–µ–Ω–æ</span>
                                        </div>
                                        <div class="d-flex gap-1 flex-wrap">
                                            <a href="{% url 'fanfic_detail' fanfic.pk %}" class="btn btn-sm btn-outline-info">
                                                <i class="bi bi-eye me-1"></i>–ü—Ä–æ—á–∏—Ç–∞—Ç—å
                                            </a>
                                            <a href="{% url 'fanfic_edit' fanfic.pk %}" class="btn btn-sm btn-outline-primary">
                                                <i class="bi bi-pencil me-1"></i>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                            </a>
                                            <a href="{% url 'publish_fanfic' fanfic.pk %}" 
                                               class="btn btn-sm btn-outline-success">
                                                <i class="bi bi-upload me-1"></i>–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
                                            </a>
                                            <button type="button" class="btn btn-sm btn-outline-danger" 
                                                    data-bs-toggle="modal" data-bs-target="#moveToTrashModal{{ fanfic.id }}">
                                                <i class="bi bi-trash me-1"></i>–£–¥–∞–ª–∏—Ç—å
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center text-muted">
                            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- –ê—Ä—Ö–∏–≤ –∏—Å—Ç–æ—Ä–∏–π -->
            <div class="card mb-4">
                <div class="card-header" style="background-color: #ffc107; color: black;">
                    <h4 class="mb-0">üì¶ –ê—Ä—Ö–∏–≤ –∏—Å—Ç–æ—Ä–∏–π</h4>
                </div>
                <div class="card-body">
                    {% if archived_fanfics %}
                        <div class="list-group">
                            {% for fanfic in archived_fanfics %}
                            <div class="list-group-item">
                                <div class="d-flex w-100 justify-content-between">
                                    <h5 class="mb-1">{{ fanfic.title }}</h5>
                                    <small class="text-muted">–í –∞—Ä—Ö–∏–≤–µ —Å: {{ fanfic.updated_at|date:"d.m.Y" }}</small>
                                </div>
                                {% if fanfic.description %}
                                <p class="mb-1">{{ fanfic.description|truncatewords:20 }}</p>
                                {% endif %}
                                {% if fanfic.tags %}
                                <div class="mb-3">
                                    {% for tag in fanfic.get_tags_list %}
                                    <span class="badge bg-warning text-dark me-1">{{ tag }}</span>
                                    {% endfor %}
                                </div>
                                {% endif %}
                                <div class="d-flex gap-1 flex-wrap">
                                    <a href="{% url 'fanfic_detail' fanfic.pk %}" class="btn btn-sm btn-outline-info me-1">
                                        <i class="bi bi-eye me-1"></i>–ü—Ä–æ—á–∏—Ç–∞—Ç—å
                                    </a>
                                    <a href="{% url 'publish_fanfic' fanfic.pk %}" 
                                       class="btn btn-sm btn-outline-success me-1">
                                        <i class="bi bi-upload me-1"></i>–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
                                    </a>
                                    <button type="button" class="btn btn-sm btn-outline-danger" 
                                            data-bs-toggle="modal" data-bs-target="#moveToTrashModal{{ fanfic.id }}">
                                        <i class="bi bi-trash me-1"></i>–£–¥–∞–ª–∏—Ç—å
                                    </button>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center text-muted">
                            <p>–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- –ö–æ—Ä–∑–∏–Ω–∞ -->
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #dc3545; color: white;">
                    <h4 class="mb-0">üóëÔ∏è –ö–æ—Ä–∑–∏–Ω–∞</h4>
                    {% if deleted_fanfics %}
                    <button type="button" class="btn btn-sm btn-light" data-bs-toggle="modal" data-bs-target="#clearTrashModal">
                        –û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                    {% endif %}
                </div>
                <div class="card-body">
                    <div class="alert alert-warning">
                        <strong>–í–Ω–∏–º–∞–Ω–∏–µ!</strong> –ò—Å—Ç–æ—Ä–∏–∏ –±—É–¥—É—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª–µ–Ω—ã —á–µ—Ä–µ–∑ 30 –¥–Ω–µ–π.
                    </div>
                    
                    {% if deleted_fanfics %}
                        <div class="row g-3">
                            {% for fanfic in deleted_fanfics %}
                            <div class="col-12">
                                <div class="card border-danger">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                            <h5 class="card-title mb-0">{{ fanfic.title }}</h5>
                                            <div>
                                                <small class="text-muted">
                                                    {% if fanfic.deleted_at %}
                                                        –£–¥–∞–ª–µ–Ω–æ: {{ fanfic.deleted_at|date:"d.m.Y H:i" }}
                                                    {% else %}
                                                        –£–¥–∞–ª–µ–Ω–æ: {{ fanfic.updated_at|date:"d.m.Y H:i" }}
                                                    {% endif %}
                                                </small>
                                                <span class="badge bg-danger ms-2">
                                                    {% if fanfic.purge_at %}
                                                        –£–¥–∞–ª–∏—Ç—Å—è: {{ fanfic.purge_at|date:"d.m.Y" }}
                                                    {% else %}
                                                        –£–¥–∞–ª–∏—Ç—Å—è: —Å–∫–æ—Ä–æ
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>
                                        
                                        {% if fanfic.description %}
                                        <p class="card-text">{{ fanfic.description|truncatewords:30 }}</p>
                                        {% endif %}
                                        
                                        <div class="mb-3">
                                            <span class="badge bg-danger me-1">–í –∫–æ—Ä–∑–∏–Ω–µ</span>
                                            <span class="badge bg-warning text-dark">
                                                –û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π: 
                                                {% if fanfic.days_until_purge %}
                                                    {{ fanfic.days_until_purge }}
                                                {% else %}
                                                    30
                                                {% endif %}
                                            </span>
                                            {% if fanfic.tags %}
                                            <div class="mt-2">
                                                {% for tag in fanfic.get_tags_list %}
                                                <span class="badge bg-secondary me-1">{{ tag }}</span>
                                                {% endfor %}
                                            </div>
                                            {% endif %}
                                        </div>
                                        
                                        <div class="d-flex gap-1 flex-wrap">
                                            <a href="{% url 'restore_from_trash' fanfic.pk %}" 
                                               class="btn btn-sm btn-outline-success">
                                                –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
                                            </a>
                                            <a href="{% url 'fanfic_detail' fanfic.pk %}" 
                                               class="btn btn-sm btn-outline-secondary">
                                                –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
                                            </a>
                                            <button type="button" class="btn btn-sm btn-outline-dark" 
                                                    data-bs-toggle="modal" data-bs-target="#deletePermanentlyModal{{ fanfic.id }}">
                                                –£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center text-muted py-4">
                            <p class="mb-0">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è "–£–¥–∞–ª–∏—Ç—å" (–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É) -->
{% for fanfic in published_fanfics %}
<div class="modal fade" id="moveToTrashModal{{ fanfic.id }}" tabindex="-1" aria-labelledby="moveToTrashModalLabel{{ fanfic.id }}" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="moveToTrashModalLabel{{ fanfic.id }}" style="color: #453518;">
                    <i class="bi bi-trash me-2 text-danger"></i>–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-3">
                    <i class="bi bi-exclamation-triangle display-1 text-warning mb-3"></i>
                    <h4 class="h4 mb-3" style="color: #453518;">–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É?</h4>
                    <p class="text-muted mb-3">
                        –§–∞–Ω—Ñ–∏–∫ "<strong>{{ fanfic.title }}</strong>" –±—É–¥–µ—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É.
                    </p>
                    <div class="alert alert-warning">
                        <i class="bi bi-info-circle me-2"></i>
                        –§–∞–Ω—Ñ–∏–∫ –±—É–¥–µ—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª–µ–Ω —á–µ—Ä–µ–∑ <strong>30 –¥–Ω–µ–π</strong>
                    </div>
                </div>
                
                <p class="text-dark mb-3">–í—ã —Å–º–æ–∂–µ—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–Ω—Ñ–∏–∫ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <form method="post" action="{% url 'move_to_trash' fanfic.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-warning">
                        <i class="bi bi-trash me-2"></i>–î–∞, –≤ –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endfor %}

{% for fanfic in draft_fanfics %}
<div class="modal fade" id="moveToTrashModal{{ fanfic.id }}" tabindex="-1" aria-labelledby="moveToTrashModalLabel{{ fanfic.id }}" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="moveToTrashModalLabel{{ fanfic.id }}" style="color: #453518;">
                    <i class="bi bi-trash me-2 text-danger"></i>–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫ –≤ –∫–æ—Ä–∑–∏–Ω—É
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-3">
                    <i class="bi bi-exclamation-triangle display-1 text-warning mb-3"></i>
                    <h4 class="h4 mb-3" style="color: #453518;">–£–¥–∞–ª–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫?</h4>
                    <p class="text-muted mb-3">
                        –ß–µ—Ä–Ω–æ–≤–∏–∫ "<strong>{{ fanfic.title }}</strong>" –±—É–¥–µ—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É.
                    </p>
                    <div class="alert alert-warning">
                        <i class="bi bi-info-circle me-2"></i>
                        –ß–µ—Ä–Ω–æ–≤–∏–∫ –±—É–¥–µ—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª–µ–Ω —á–µ—Ä–µ–∑ <strong>30 –¥–Ω–µ–π</strong>
                    </div>
                </div>
                
                <p class="text-dark mb-3">–í—ã —Å–º–æ–∂–µ—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <form method="post" action="{% url 'move_to_trash' fanfic.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-warning">
                        <i class="bi bi-trash me-2"></i>–î–∞, –≤ –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endfor %}

{% for fanfic in archived_fanfics %}
<div class="modal fade" id="moveToTrashModal{{ fanfic.id }}" tabindex="-1" aria-labelledby="moveToTrashModalLabel{{ fanfic.id }}" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="moveToTrashModalLabel{{ fanfic.id }}" style="color: #453518;">
                    <i class="bi bi-trash me-2 text-danger"></i>–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∞—Ä—Ö–∏–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-3">
                    <i class="bi bi-exclamation-triangle display-1 text-warning mb-3"></i>
                    <h4 class="h4 mb-3" style="color: #453518;">–£–¥–∞–ª–∏—Ç—å –∏–∑ –∞—Ä—Ö–∏–≤–∞?</h4>
                    <p class="text-muted mb-3">
                        –ê—Ä—Ö–∏–≤–Ω–∞—è –∑–∞–ø–∏—Å—å "<strong>{{ fanfic.title }}</strong>" –±—É–¥–µ—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É.
                    </p>
                    <div class="alert alert-warning">
                        <i class="bi bi-info-circle me-2"></i>
                        –§–∞–Ω—Ñ–∏–∫ –±—É–¥–µ—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª–µ–Ω —á–µ—Ä–µ–∑ <strong>30 –¥–Ω–µ–π</strong>
                    </div>
                </div>
                
                <p class="text-dark mb-3">–í—ã —Å–º–æ–∂–µ—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–Ω—Ñ–∏–∫ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <form method="post" action="{% url 'move_to_trash' fanfic.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-warning">
                        <i class="bi bi-trash me-2"></i>–î–∞, –≤ –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endfor %}

<!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è "–£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞" (–∏–∑ –∫–æ—Ä–∑–∏–Ω—ã) -->
{% for fanfic in deleted_fanfics %}
<div class="modal fade" id="deletePermanentlyModal{{ fanfic.id }}" tabindex="-1" aria-labelledby="deletePermanentlyModalLabel{{ fanfic.id }}" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deletePermanentlyModalLabel{{ fanfic.id }}" style="color: #453518;">
                    <i class="bi bi-exclamation-triangle me-2 text-danger"></i>–£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞–≤—Å–µ–≥–¥–∞
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-3">
                    <i class="bi bi-trash3 display-1 text-danger mb-3"></i>
                    <h4 class="h4 mb-3" style="color: #453518;">–£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞?</h4>
                    <p class="text-muted mb-3">
                        –§–∞–Ω—Ñ–∏–∫ "<strong>{{ fanfic.title }}</strong>" –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ.
                    </p>
                    <div class="alert alert-danger">
                        <i class="bi bi-exclamation-circle me-2"></i>
                        –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –±—É–¥–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å!
                    </div>
                </div>
                
                <div class="mb-3">
                    <p class="text-dark mb-2 fw-bold">–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –≤—ã –ø–æ—Ç–µ—Ä—è–µ—Ç–µ:</p>
                    <ul class="text-start" style="list-style: none; padding-left: 0;">
                        <li class="mb-1"><i class="bi bi-x-circle text-danger me-2"></i>–í–µ—Å—å —Ç–µ–∫—Å—Ç —Ñ–∞–Ω—Ñ–∏–∫–∞</li>
                        <li class="mb-1"><i class="bi bi-x-circle text-danger me-2"></i>–í—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –æ—Ç–∑—ã–≤—ã</li>
                        <li class="mb-1"><i class="bi bi-x-circle text-danger me-2"></i>–í—Å–µ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</li>
                        <li class="mb-1"><i class="bi bi-x-circle text-danger me-2"></i>–í—Å–µ —Ç–µ–≥–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ</li>
                    </ul>
                </div>
                
                {% if fanfic.days_until_purge %}
                <div class="alert alert-warning">
                    <i class="bi bi-clock me-2"></i>
                    –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª—è—Ç—å —Å–µ–π—á–∞—Å, —Ñ–∞–Ω—Ñ–∏–∫ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª–µ–Ω —á–µ—Ä–µ–∑ <strong>{{ fanfic.days_until_purge }}</strong> –¥–Ω–µ–π
                </div>
                {% endif %}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <form method="post" action="{% url 'delete_permanently' fanfic.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">
                        <i class="bi bi-check-circle me-2"></i>–î–∞, —É–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endfor %}

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã -->
{% if deleted_fanfics %}
<div class="modal fade" id="clearTrashModal" tabindex="-1" aria-labelledby="clearTrashModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="clearTrashModalLabel" style="color: #453518;">
                    <i class="bi bi-exclamation-triangle me-2 text-danger"></i>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—á–∏—Å—Ç–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-3">
                    <i class="bi bi-trash3 display-1 text-danger mb-3"></i>
                    <h4 class="h4 mb-3" style="color: #453518;">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –∫–æ—Ä–∑–∏–Ω—É?</h4>
                    <p class="text-muted mb-3">
                        –í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ñ–∞–Ω—Ñ–∏–∫–∏ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ.
                    </p>
                    <div class="alert alert-danger">
                        <i class="bi bi-exclamation-circle me-2"></i>
                        –í—Å–µ–≥–æ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ: <strong>{{ deleted_fanfics|length }}</strong> —Ñ–∞–Ω—Ñ–∏–∫–æ–≤
                    </div>
                </div>
                
                <div class="mb-3">
                    <p class="text-dark mb-2 fw-bold">–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –≤—ã –Ω–µ —Å–º–æ–∂–µ—Ç–µ:</p>
                    <ul class="text-start" style="list-style: none; padding-left: 0;">
                        <li class="mb-1"><i class="bi bi-x-circle text-danger me-2"></i>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ–∞–Ω—Ñ–∏–∫–∏</li>
                        <li class="mb-1"><i class="bi bi-x-circle text-danger me-2"></i>–í–µ—Ä–Ω—É—Ç—å –∏—Ö –≤ –∞—Ä—Ö–∏–≤ –∏–ª–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∏</li>
                        <li class="mb-1"><i class="bi bi-x-circle text-danger me-2"></i>–ù–∞–π—Ç–∏ –∏—Ö —á–µ—Ä–µ–∑ –ø–æ–∏—Å–∫ –∏–ª–∏ —Ç–µ–≥–∏</li>
                    </ul>
                </div>
                
                <div class="alert alert-warning">
                    <i class="bi bi-info-circle me-2"></i>
                    –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –Ω–∞–≤—Å–µ–≥–¥–∞.
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <form method="post" action="{% url 'empty_trash' %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">
                        <i class="bi bi-check-circle me-2"></i>–î–∞, –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endif %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    // –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
                observer.unobserve(entry.target);
            }
        });
    }, observerOptions);
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
    document.querySelectorAll('.card, .list-group-item').forEach(function(card) {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
        observer.observe(card);
    });
});
</script>
{% endblock %}